# - - - - - - - - - - - - - - - - - - - - -
# Empire edicts
# - - - - - - - - - - - - - - - - - - - - -

@Edict1Cost = 10
@Edict2Cost = 20
@Edict3Cost = 30

@EdictPerpetual = -1

@EdictDuration = 3600
@ambitionDuration = 3600

@tec_convergence_duration = 1800

# -------------------------- AIAUTH
tec_aiauth_menu = {	# Biopsionic
	icon = "GFX_edict_type_time"
	length = 1
	# Note: seems = 0 crashes the game somehow
	resources = {
		category = country	# To avoid scaling
		cost = {
			energy = 0
		}
	}
	potential = {
		tec_is_aiauth_empire = yes
	}
	effect = {
		country_event = {
			id = tec_aiauth.100
			days = 0 
		}
	}
	allow = {
		NOT = {
			has_country_flag = tec_active_aiauth_window
		}
	}
	ai_weight = {
		weight = 0
	}
}
# -------------------------- Cultural overhaul edicts
#Immortal Ruler
immortal_ruler = {
	icon = "GFX_edict_type_time"
	length = 1
	resources = {
		category = edicts
		cost = {
			influence = 300
		}
	}
	
	potential = {
		always = no	# deprecated
		has_valid_civic = civic_imperial_cult
		NOT = { has_country_flag = flag_immortal_ruler }
	}

	effect = {
		country_event = { id = immortal_ruler.1 }
		}
	
	
	ai_weight = {
		weight = 1
	}
}


#Patriotic Call
patriotic_call = {
	icon = "GFX_edict_type_time"
	length = @EdictDuration
	resources = {
		category = edicts
		cost = {
			influence = @Edict2Cost
		}
	}
	
	potential = {
		always = no # deprecated
		has_valid_civic = civic_citizen_service
	}

	modifier = {
		
		country_naval_cap_mult = 0.1
		country_war_exhaustion_mult = -0.15
		army_morale = 0.2
		
	}
	
	
	ai_weight = {
		weight = 1
	}
}


#Divine Crusade
div_crusade = {
	icon = "GFX_edict_type_time"
	length = @ambitionDuration
	
	is_ambition = yes
	resources = {
		category = edicts
	}
	potential = {
		always = no # deprecated
		has_valid_civic = civic_tec_regular_crusaders
	}
	
	allow = {
		has_technology = tech_ascension_theory
	}

	modifier = {		
		max_rivalries = 1
		country_war_exhaustion_mult = -1
		ship_fire_rate_mult = 0.10
	}
	
	
	ai_weight = {
		weight = 1
	}
}

# -------------------------- Evolved edicts
# Perpetual edicts
tec_arcane_dwelvers = {
	length = @EdictPerpetual
	icon = "GFX_edict_type_policy"

	resources = {
		category = country	# To avoid scaling
		#edicts
		cost = { #Activation Cost
			trigger = {
				NOT = { has_edict = tec_arcane_dwelvers }
			}
			minor_artifacts = 50	#@Edict1Cost
		}
		cost = { #Deactivation Cost
			trigger = {
				has_edict = tec_arcane_dwelvers
			}
			minor_artifacts = 50	#@Edict1Cost
		}
	}

	modifier = {
		country_base_minor_artifacts_produces_add = 0.5
		planet_researchers_produces_mult = 0.05
		country_unity_produces_mult = 0.05
	}

	potential = {
		is_galactic_community_member = yes
		OR = {
			has_global_flag = resolution_arcane_tech_allow
		}
	}

	ai_weight = {
		weight = @EdictHighPrio
	}
}

tec_equality_edict = {
	length = @EdictPerpetual
	icon = "GFX_edict_type_policy"

	resources = {
		category = edicts
		upkeep = {
			unity = @Edict1Cost
			multiplier = value:edict_size_effect
		}
	}

	modifier = {
		planet_resettlement_unemployed_mult = 2.00
		pop_demotion_time_mult = -0.25
	}

	potential = {
		is_pluralist = yes
	}

	ai_weight = {
		weight = @EdictLowPrio
	}
}

tec_social_state_edict = {
	length = @EdictPerpetual
	icon = "GFX_edict_type_policy"

	resources = {
		category = edicts
		upkeep = {
			unity = @Edict1Cost
			multiplier = value:edict_size_effect
		}
	}

	modifier = {
		pop_citizen_happiness = 0.05
		planet_clerks_unity_produces_add = 1
		planet_pops_consumer_goods_upkeep_mult = 0.1
	}

	potential = {
		is_cooperative = yes
	}

	ai_weight = {
		weight = @EdictHighPrio
	}
}

tec_mortgage_edict = {
	length = @EdictPerpetual
	icon = "GFX_edict_type_policy"

	resources = {
		category = edicts
		upkeep = {
			unity = @Edict2Cost
			multiplier = value:edict_size_effect
		}
	}

	potential = {
		has_valid_civic = civic_tec_corporate_reanimators
	}

	ai_weight = {
		weight = 0
	}
}

# Campaigns
tec_biopsionic_convergence_edict = {	# Biopsionic
	length = @tec_convergence_duration
	icon = "GFX_edict_type_time"
	resources = {
		category = country	# To avoid scaling
		cost = {
			sr_zro = 100
		}
	}
	potential = {
		has_country_flag = tec_biopsionic_path_finished
	}
	effect = {
		country_event = {
			id = tec_biopsionic_path.350
			days = 0 
		}
		hidden_effect = {
			if = {
				limit = {
					NOR = {
						has_country_flag = tec_biopsionic_converged_gate
						has_country_flag = tec_biopsionic_converged_traits
					}
				}
				set_timed_country_flag = {
					flag = tec_biopsionic_converged_gate
					months = 2
				}
				country_event = {
					id = tec_biopsionic_path.360
					days = 30
					random = 30
				}
			}
		}
	}
	ai_weight = {
		weight = @EdictHighPrio
	}
}


# Debug

@situation_tec_gene_path_t1 = "situation_tec_gene_path_t1"

tec_fix_my_ascension = {	# Debug wrong ascensions
	length = 1
	icon = "GFX_edict_type_time"
	resources = {
		category = country	# To avoid scaling
	}
	potential = {
		always = no
		any_playable_country = {
			OR = {
				has_country_flag = tec_biological_assimilation
				has_country_flag = tec_genetics_t2_completed
				any_owned_planet = {
					is_colony = yes
					has_planet_flag = tec_block_other_specialziations
				}
				AND = {
					has_country_flag = tec_biopsionic_assimilation
					owner_main_species = {
						NOT = {
							has_trait = trait_tec_biopsionic_main
						}
					}
				}
				AND = {
					has_country_flag = tec_cyberpsionic_path_finished
					owner_main_species = {
						NOT = {
							has_trait = trait_tec_cyberpsionic_main
						}
					}
				}
			}
		}
		NOT = { has_global_flag = tec_fix_my_ascension_R5B }
	}
	effect = {
		set_global_flag = tec_fix_my_ascension_R5B
		if = {	# Fix flag
			limit = {
				any_playable_country = {
					has_country_flag = tec_biological_assimilation
				}
			}
			every_playable_country = {
				limit = {
					has_country_flag = tec_biological_assimilation
				}
				remove_country_flag = tec_biological_assimilation
				set_country_flag = tec_genetic_assimilation
			}
		}
		if = {	# Fix flag
			limit = {
				any_playable_country = {
					has_country_flag = tec_genetics_t2_completed
				}
			}
			every_playable_country = {
				limit = {
					has_country_flag = tec_genetics_t2_completed
				}
				remove_country_flag = tec_genetics_t2_completed
				set_country_flag = tec_gene_path_finished
			}
		}
		if = {	# Fix planet flag
			limit = {
				any_playable_country = {
					any_owned_planet = {
						is_colony = yes
						has_planet_flag = tec_block_other_specialziations
					}
				}
			}
			every_playable_country = {
				limit = {
					any_owned_planet = {
						is_colony = yes
						has_planet_flag = tec_block_other_specialziations
					}
				}
				every_owned_planet = {
					limit = {
						has_country_flag = tec_block_other_specialziations
					}
					remove_planet_flag = tec_block_other_specialziations
				}
			}
		}
		if = {	# Fix biopsionic
			limit = {
				any_playable_country = {
					has_country_flag = tec_biopsionic_assimilation
					owner_main_species = {
						NOT = {
							has_trait = trait_tec_biopsionic_main
						}
					}
				}
			}
			every_playable_country = {
				limit = {
					has_country_flag = tec_biopsionic_assimilation
					owner_main_species = {
						NOT = {
							has_trait = trait_tec_biopsionic_main
						}
					}
				}
				tec_give_biopsionic_t2_finished_effect = yes
				remove_country_flag = tec_advanced_ascension
			}
		}

		if = {	# Fix cyberpsionic
			limit = {
				any_playable_country = {
					has_country_flag = tec_cyberpsionic_path_finished
					owner_main_species = {
						NOT = {
							has_trait = trait_tec_cyberpsionic_main
						}
					}
				}
			}
			every_playable_country = {
				limit = {
					has_country_flag = tec_cyberpsionic_path_finished
					owner_main_species = {
						NOT = {
							has_trait = trait_tec_cyberpsionic_main
						}
					}
				}
				tec_give_cyberpsionic_t2_finished_effect = yes
				remove_country_flag = tec_advanced_ascension
			}
		}

	}
	ai_weight = {
		weight = 99999
	}
}