# ----------------------------------------
#		R E G U L A R	T I L E S E T
# ----------------------------------------

# % production will always be before
# ------------- ENERGY -----------------
	building_energy_grid = {
		base_buildtime = @b1_time
		base_cap_amount = 1
		position_priority = 210		# Basic boost
		ai_estimate_without_unemployment = yes

		category = resource

		prerequisites = {
			tech_power_hub_1
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}
		
		upgrades = {
			building_energy_nexus
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			NOR = {
				has_modifier = resort_colony
				has_modifier = crucible_colony
			}
			OR = {
				NOT = {
					uses_habitat_capitals = yes
				}
				AND = {
					exists = owner
					owner = { is_gestalt = yes }
				}
				tec_energy_prod_building_exception = yes
			}
			tec_ai_destroy_energy_boosting_building = no
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 1
			}
		}

		# Modifiers
			inline_script = {
				script = modifiers/inline_evolved_technician_efficiency
				count = 1
				mult = 1
				trigger = ""
			}

			triggered_planet_modifier = {
				potential = {
					exists = owner
					owner = { is_machine_empire = yes }
				}
				planet_tec_batteries_energy_produces_add = 1
			}
		# /

		# Jobs
			inline_script = {
				script = jobs/inline_evolved_technician
				regular_count = 1
				regular_secondary_count = 1
				hive_count = 1
				hive_secondary_count = 1
				machine_count = 1
				machine_secondary_count = 1
				mult = 1
				display = with_desc
				trigger = ""
			}
		# /

		inline_script = {
			script = buildings/effects/type/inline_evolved_energy_grid
			tier = 1
		}

		# AI
			inline_script = {
				script = buildings/inline_evolved_aibait
				trigger = "
					check_variable_arithmetic = {
						which = value:generator_combined_value
						value >= 4
					}
				"
			}
		# /
	}

	building_energy_nexus = {
		base_buildtime = @b2_time
		can_build = no
		position_priority = 210		# Basic boost
		ai_estimate_without_unemployment = yes

		category = resource


		prerequisites = {
			tech_power_hub_2
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			NOR = {
				has_modifier = resort_colony
				has_modifier = crucible_colony
			}
			OR = {
				NOT = {
					uses_habitat_capitals = yes
				}
				AND = {
					exists = owner
					owner = { is_gestalt = yes }
				}
				tec_energy_prod_building_exception = yes
			}
			tec_ai_destroy_energy_boosting_building = no
		}

		allow = {
			has_upgraded_capital = yes
			tec_ai_allow_rare_dependant_building = {
				tier = 2
				rare = exotic_gases
			}
		}

		upgrades = {
			"building_energy_complex"
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 2
			}

			inline_script = {
				script = buildings/resources/inline_evolved_rare_resource_cost
				tier = 2
				rare = exotic_gases
			}

			inline_script = {
				script = buildings/resources/inline_evolved_ring_production_cost
				rare = exotic_gases
				type = menial
			}
		}

		# Modifiers
			inline_script = {
				script = modifiers/inline_evolved_technician_efficiency
				count = 2
				mult = 1
				trigger = ""
			}

			triggered_planet_modifier = {
				potential = {
					exists = owner
					owner = { is_machine_empire = yes }
				}
				planet_tec_batteries_energy_produces_add = 2
			}

			inline_script = {
				script = modifiers/inline_evolved_technician_efficiency
				count = 1
				mult = 1
				trigger = "
					has_ringworld_output_boost = yes
				"
			}
		# /

		# Jobs
			inline_script = {
				script = jobs/inline_evolved_technician
				regular_count = 2
				regular_secondary_count = 2
				hive_count = 2
				hive_secondary_count = 2
				machine_count = 2
				machine_secondary_count = 2
				mult = 1
				display = with_desc
				trigger = ""
			}
		# /

		inline_script = {
			script = buildings/effects/type/inline_evolved_energy_grid
			tier = 2
		}

		# AI
			inline_script = {
				script = buildings/inline_evolved_aibait
				trigger = ""
			}
		# /
	}

	building_energy_complex = {
		icon = building_tec_energy_complex
		base_buildtime = @b3_time
		can_build = no
		position_priority = 210		# Basic boost
		ai_estimate_without_unemployment = yes

		category = resource

		prerequisites = {
			"tech_tec_power_hub_3"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			NOR = {
				has_modifier = resort_colony
				has_modifier = crucible_colony
			}
			OR = {
				NOT = {
					uses_habitat_capitals = yes
				}
				AND = {
					exists = owner
					owner = { is_gestalt = yes }
				}
				tec_energy_prod_building_exception = yes
			}
			tec_ai_destroy_energy_boosting_building = no
		}

		allow = {
			has_upgraded_capital = yes
			tec_ai_allow_rare_dependant_building = {
				tier = 3
				rare = exotic_gases
			}
			tec_ai_allow_exotic_dependant_building = {
				exotic = sr_living_metal
			}
		}
			
		resources = {
			category = planet_buildings

			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 4
			}

			inline_script = {
				script = buildings/resources/inline_evolved_rare_resource_cost
				tier = 3
				rare = exotic_gases
			}

			inline_script = {
				script = buildings/resources/inline_evolved_exotic_resource_cost
				exotic = sr_living_metal
			}

			inline_script = {
				script = buildings/resources/inline_evolved_ring_production_cost
				rare = exotic_gases
				type = menial
			}
		}

		# Modifiers
			inline_script = {
				script = modifiers/inline_evolved_technician_efficiency
				count = 3
				mult = 1
				trigger = ""
			}

			triggered_planet_modifier = {
				potential = {
					exists = owner
					owner = { is_machine_empire = yes }
				}
				planet_tec_batteries_energy_produces_add = 3
			}


			inline_script = {
				script = modifiers/inline_evolved_technician_efficiency
				count = 2
				mult = 1
				trigger = "
					has_ringworld_output_boost = yes
				"
			}
		# /

		# Jobs
			inline_script = {
				script = jobs/inline_evolved_technician
				regular_count = 4
				regular_secondary_count = 4
				hive_count = 4
				hive_secondary_count = 4
				machine_count = 4
				machine_secondary_count = 4
				mult = 1
				display = with_desc
				trigger = ""
			}
		# /

		inline_script = {
			script = buildings/effects/type/inline_evolved_energy_grid
			tier = 3
		}

		# AI
			inline_script = {
				script = buildings/inline_evolved_aibait
				trigger = ""
			}
		# /
	}
# /
# ------------- MINERALS -----------------
	building_mineral_purification_plant = {
		base_buildtime = @b1_time
		base_cap_amount = 1
		position_priority = 210		# Basic boost
		ai_estimate_without_unemployment = yes

		category = resource

		prerequisites = {
			tech_mineral_purification_1
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		upgrades = {
			building_mineral_purification_hub
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			NOR = {
				has_modifier = resort_colony
				has_modifier = crucible_colony
			}

			NOR = { # Ringworlds don't have mines
				tec_is_ringworld = yes
			}
			OR = { # Habitats only have mines if they're built on an appropriate deposit
				uses_habitat_capitals = no
				tec_mining_prod_building_exception = yes
			}
			tec_ai_destroy_minerals_boosting_building = no
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 1
			}
		}
		
		# Modifiers
			inline_script = {
				script = modifiers/inline_evolved_miner_efficiency
				count = 1
				mult = 1
				trigger = ""
			}

			triggered_planet_modifier = {
				potential = {
					exists = owner
					owner = {
						is_machine_empire = no
						allows_slavery = yes
					}
				}
				planet_livestock_lithoid_minerals_produces_add = 1
			}
		# /

		# Jobs
			inline_script = {
				script = jobs/inline_evolved_miner
				regular_count = 1
				regular_secondary_count = 1
				hive_count = 1
				hive_secondary_count = 1
				machine_count = 1
				machine_secondary_count = 1
				mult = 1
				display = with_desc
				trigger = ""
			}
		# /

		inline_script = {
			script = buildings/effects/type/inline_evolved_mineral_purification_plant
			tier = 1
		}

		# Descs
			triggered_desc = {
				trigger = { tec_has_scrap_miner = no }
				text = building_mineral_purification_plant_desc
			}

			triggered_desc = {
				trigger = { tec_has_scrap_miner = yes }
				text = building_scrap_processing_plant_desc
			}
		# /

		# AI
			inline_script = {
				script = buildings/inline_evolved_aibait
				trigger = "
					check_variable_arithmetic = {
						which = value:mining_combined_value
						value >= 4
					}
				"
			}
		# /
	}

	building_mineral_purification_hub = {
		base_buildtime = @b2_time
		can_build = no
		position_priority = 210		# Basic boost
		ai_estimate_without_unemployment = yes

		category = resource

		prerequisites = {
			tech_mineral_purification_2
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			NOR = {
				has_modifier = resort_colony
				has_modifier = crucible_colony
			}

			NOR = { # Ringworlds don't have mines
				tec_is_ringworld = yes
			}
			OR = { # Habitats only have mines if they're built on an appropriate deposit
				uses_habitat_capitals = no
				tec_mining_prod_building_exception = yes
			}
			tec_ai_destroy_minerals_boosting_building = no
		}

		allow = {
			has_upgraded_capital = yes
			tec_ai_allow_rare_dependant_building = {
				tier = 2
				rare = rare_crystals
			}
		}

		upgrades = {
			"building_mineral_purification_complex"
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 2
			}

			inline_script = {
				script = buildings/resources/inline_evolved_rare_resource_cost
				tier = 2
				rare = rare_crystals
			}

			inline_script = {
				script = buildings/resources/inline_evolved_ring_production_cost
				rare = rare_crystals
				type = menial
			}
		}

		# Modifiers
			inline_script = {
				script = modifiers/inline_evolved_miner_efficiency
				count = 2
				mult = 1
				trigger = ""
			}

			triggered_planet_modifier = {
				potential = {
					exists = owner
					owner = {
						is_machine_empire = no
						allows_slavery = yes
					}
				}
				planet_livestock_lithoid_minerals_produces_add = 2
			}

			inline_script = {
				script = modifiers/inline_evolved_miner_efficiency
				count = 1
				mult = 1
				trigger = "
					has_ringworld_output_boost = yes
				"
			}
		# /

		# Jobs
			inline_script = {
				script = jobs/inline_evolved_miner
				regular_count = 2
				regular_secondary_count = 2
				hive_count = 2
				hive_secondary_count = 2
				machine_count = 2
				machine_secondary_count = 2
				mult = 1
				display = with_desc
				trigger = ""
			}
		# /

		# Descs
			triggered_desc = {
				trigger = { tec_has_scrap_miner = no }
				text = building_mineral_purification_hub_desc
			}

			triggered_desc = {
				trigger = { tec_has_scrap_miner = yes }
				text = building_scrap_processing_hub_desc
			}
		# /

		inline_script = {
			script = buildings/effects/type/inline_evolved_mineral_purification_plant
			tier = 2
		}

		inline_script = {
			script = buildings/inline_evolved_aibait
			trigger = ""
		}
	}

	building_mineral_purification_complex = {
		base_buildtime = @b3_time
		can_build = no
		position_priority = 210		# Basic boost
		ai_estimate_without_unemployment = yes

		category = resource

		prerequisites = {
			"tech_tec_mineral_purification_3"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			NOR = {
				has_modifier = resort_colony
				has_modifier = crucible_colony
			}

			NOR = { # Ringworlds don't have mines
				tec_is_ringworld = yes
			}
			OR = { # Habitats only have mines if they're built on an appropriate deposit
				uses_habitat_capitals = no
				tec_mining_prod_building_exception = yes
			}
			tec_ai_destroy_minerals_boosting_building = no
		}

		allow = {
			has_upgraded_capital = yes
			tec_ai_allow_rare_dependant_building = {
				tier = 3
				rare = rare_crystals
			}
			tec_ai_allow_exotic_dependant_building = {
				exotic = sr_living_metal
			}
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 4
			}

			inline_script = {
				script = buildings/resources/inline_evolved_rare_resource_cost
				tier = 3
				rare = rare_crystals
			}

			inline_script = {
				script = buildings/resources/inline_evolved_ring_production_cost
				rare = rare_crystals
				type = menial
			}

			inline_script = {
				script = buildings/resources/inline_evolved_exotic_resource_cost
				exotic = sr_living_metal
			}
		}

		# Modifiers
			inline_script = {
				script = modifiers/inline_evolved_miner_efficiency
				count = 3
				mult = 1
				trigger = ""
			}
			
			triggered_planet_modifier = {
				potential = {
					exists = owner
					owner = {
						is_machine_empire = no
						allows_slavery = yes
					}
				}
				planet_livestock_lithoid_minerals_produces_add = 3
			}

			inline_script = {
				script = modifiers/inline_evolved_miner_efficiency
				count = 2
				mult = 1
				trigger = "
					has_ringworld_output_boost = yes
				"
			}
		# /

		# Jobs
			inline_script = {
				script = jobs/inline_evolved_miner
				regular_count = 4
				regular_secondary_count = 4
				hive_count = 4
				hive_secondary_count = 4
				machine_count = 4
				machine_secondary_count = 4
				mult = 1
				display = with_desc
				trigger = ""
			}
		# /


		inline_script = {
			script = buildings/effects/type/inline_evolved_mineral_purification_plant
			tier = 3
		}

		# Descs
			triggered_desc = {
				trigger = { tec_has_scrap_miner = no }
				text = building_mineral_purification_hub_desc
			}

			triggered_desc = {
				trigger = { tec_has_scrap_miner = yes }
				text = building_scrap_processing_hub_desc
			}
		# /

		# AI
			inline_script = {
				script = buildings/inline_evolved_aibait
				trigger = ""
			}
		# /
	}
# /
# ------------- FOOD -----------------
 # Regular
	building_food_processing_facility = {
		base_buildtime = @b1_time
		base_cap_amount = 1
		position_priority = 210		# Basic boost
		ai_estimate_without_unemployment = yes

		category = resource

		prerequisites = {
			"tech_food_processing_1"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		upgrades = {
			building_food_processing_center
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			NOR = {
				uses_district_set = machine_world
				has_modifier = resort_colony
				has_modifier = crucible_colony
			}
			tec_ai_destroy_food_boosting_building = no
		}

		convert_to = {
			building_tec_biohive_food_processing_facility
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 1
			}
		}

		# Modifiers
			inline_script = {
				script = modifiers/inline_evolved_farmer_efficiency
				count = 1
				mult = 1
				trigger = ""
			}

			triggered_planet_modifier = {
				potential = {
					exists = owner
					owner = {
						is_machine_empire = no
						allows_slavery = yes
					}
				}
				planet_livestock_biological_food_produces_add = 1
			}
		# /

		# Jobs
			inline_script = {
				script = jobs/inline_evolved_farmer
				regular_count = 1
				regular_secondary_count = 1
				hive_count = 1
				hive_secondary_count = 1
				machine_count = 1
				machine_secondary_count = 1
				mult = 1
				display = with_desc
				trigger = ""
			}
		# /

		inline_script = {
			script = buildings/effects/type/inline_evolved_food_processing_facility
			tier = 1
		}

		# AI
			inline_script = {
				script = buildings/inline_evolved_aibait
				trigger = "
					check_variable_arithmetic = {
						which = value:farming_combined_value
						value >= 4
					}
				"
			}
		# /
	}

	building_food_processing_center = {
		base_buildtime = @b2_time
		can_build = no
		position_priority = 210		# Basic boost
		ai_estimate_without_unemployment = yes
		
		category = resource

		prerequisites = {
			"tech_food_processing_2"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		upgrades = {
			"building_food_processing_complex"
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			NOR = {
				uses_district_set = machine_world
				has_modifier = resort_colony
				has_modifier = crucible_colony
			}
			tec_ai_destroy_food_boosting_building = no
		}
		
		allow = {
			exists = owner
			has_upgraded_capital = yes
			tec_ai_allow_rare_dependant_building = {
				tier = 2
				rare = volatile_motes
			}
		}

		convert_to = {
			building_tec_biohive_food_processing_center
		}
		
		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 2
			}

			inline_script = {
				script = buildings/resources/inline_evolved_rare_resource_cost
				tier = 2
				rare = volatile_motes
			}

			inline_script = {
				script = buildings/resources/inline_evolved_ring_production_cost
				rare = volatile_motes
				type = menial
			}
		}

		# Modifiers
			# Standard
				inline_script = {
					script = modifiers/inline_evolved_farmer_efficiency
					count = 2
					mult = 1
					trigger = ""
				}

				triggered_planet_modifier = {
					potential = {
						exists = owner
						owner = {
							is_machine_empire = no
							allows_slavery = yes
						}
					}
					planet_livestock_biological_food_produces_add = 2
				}

				inline_script = {
					script = modifiers/inline_evolved_farmer_efficiency
					count = 1
					mult = 1
					trigger = "
						has_ringworld_output_boost = yes
					"
				}
			# /
		# /

		# Jobs
			inline_script = {
				script = jobs/inline_evolved_farmer
				regular_count = 2
				regular_secondary_count = 2
				hive_count = 2
				hive_secondary_count = 2
				machine_count = 2
				machine_secondary_count = 2
				mult = 1
				display = with_desc
				trigger = ""
			}
		# /
		inline_script = {
			script = buildings/effects/type/inline_evolved_food_processing_facility
			tier = 2
		}

		# AI
			inline_script = {
				script = buildings/inline_evolved_aibait
				trigger = "
					exists = owner
					owner = {
						has_monthly_income = {
							resource = food
							value < 50
						}
					}
				"
			}
		# /
	}

	building_food_processing_complex = {
		base_buildtime = @b3_time
		can_build = no
		position_priority = 210		# Basic boost
		ai_estimate_without_unemployment = yes

		category = resource

		prerequisites = {
			"tech_tec_food_processing_3"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			NOR = {
				uses_district_set = machine_world
				has_modifier = resort_colony
				has_modifier = crucible_colony
			}
			tec_ai_destroy_food_boosting_building = no
		}

		allow = {
			has_upgraded_capital = yes
			tec_ai_allow_rare_dependant_building = {
				tier = 3
				rare = volatile_motes
			}
			tec_ai_allow_exotic_dependant_building = {
				exotic = sr_living_metal
			}
		}

		convert_to = {
			building_tec_biohive_food_processing_complex
		}
		
		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 4
			}

			inline_script = {
				script = buildings/resources/inline_evolved_rare_resource_cost
				tier = 3
				rare = volatile_motes
			}

			inline_script = {
				script = buildings/resources/inline_evolved_ring_production_cost
				rare = volatile_motes
				type = menial
			}

			inline_script = {
				script = buildings/resources/inline_evolved_exotic_resource_cost
				exotic = sr_living_metal
			}
		}

		# Modifiers
			# Standard
				inline_script = {
					script = modifiers/inline_evolved_farmer_efficiency
					count = 3
					mult = 1
					trigger = ""
				}

				triggered_planet_modifier = {
					potential = {
						exists = owner
						owner = {
							is_machine_empire = no
							allows_slavery = yes
						}
					}
					planet_livestock_biological_food_produces_add = 3
				}

				inline_script = {
					script = modifiers/inline_evolved_farmer_efficiency
					count = 2
					mult = 1
					trigger = "
						has_ringworld_output_boost = yes
					"
				}
			# /
		# /

		# Jobs
			inline_script = {
				script = jobs/inline_evolved_farmer
				regular_count = 4
				regular_secondary_count = 4
				hive_count = 4
				hive_secondary_count = 4
				machine_count = 4
				machine_secondary_count = 4
				mult = 1
				display = with_desc
				trigger = ""
			}
		# /

		inline_script = {
			script = buildings/effects/type/inline_evolved_food_processing_facility
			tier = 3
		}

		# AI
			inline_script = {
				script = buildings/inline_evolved_aibait
				trigger = "
					exists = owner
					owner = {
						has_monthly_income = {
							resource = food
							value < 100
						}
					}
				"
			}
		# /
	}
 # /
 # Biohive
	building_tec_biohive_food_processing_facility = {
		base_buildtime = @b1_time
		base_cap_amount = 1
		position_priority = 210		# Basic boost
		ai_estimate_without_unemployment = yes

		category = resource

		prerequisites = {
			"tech_food_processing_1"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		upgrades = {
			building_tec_biohive_food_processing_center
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
			NOR = {
				uses_district_set = machine_world
				has_modifier = resort_colony
			}
			has_any_farming_district_or_buildings = no
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 1
			}
		}

		inline_script = {
			script = modifiers/inline_evolved_farmer_efficiency
			count = 1
			mult = 1
			trigger = ""
		}

		triggered_planet_modifier = {
			planet_livestock_biological_food_produces_add = 3
		}

		inline_script = {
			script = jobs/inline_evolved_farmer
			regular_count = 1
			regular_secondary_count = 1
			hive_count = 1
			hive_secondary_count = 1
			machine_count = 1
			machine_secondary_count = 1
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/inline_evolved_food_processing_facility
			tier = 1
		}

		inline_script = {
			script = buildings/inline_evolved_aibait
			trigger = "
				check_variable_arithmetic = {
					which = value:farming_combined_value
					value >= 4
				}
			"
		}
	}

	building_tec_biohive_food_processing_center = {
		base_buildtime = @b2_time
		can_build = no
		position_priority = 210		# Basic boost
		ai_estimate_without_unemployment = yes
		
		category = resource

		prerequisites = {
			"tech_food_processing_2"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		upgrades = {
			"building_tec_biohive_food_processing_complex"
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
			NOR = {
				uses_district_set = machine_world
				has_modifier = resort_colony
			}
			
			has_any_farming_district_or_buildings = no
		}
		
		allow = {
			exists = owner
			has_upgraded_capital = yes
			tec_ai_allow_rare_dependant_building = {
				tier = 2
				rare = volatile_motes
			}
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 2
			}

			inline_script = {
				script = buildings/resources/inline_evolved_rare_resource_cost
				tier = 2
				rare = volatile_motes
			}

			inline_script = {
				script = buildings/resources/inline_evolved_ring_production_cost
				rare = volatile_motes
				type = menial
			}
		}

		inline_script = {
			script = modifiers/inline_evolved_farmer_efficiency
			count = 2
			mult = 1
			trigger = ""
		}

		triggered_planet_modifier = {
			planet_livestock_biological_food_produces_add = 2
		}

		inline_script = {
			script = modifiers/inline_evolved_farmer_efficiency
			count = 1
			mult = 1
			trigger = "
				has_ringworld_output_boost = yes
			"
		}

		inline_script = {
			script = jobs/inline_evolved_farmer
			regular_count = 2
			regular_secondary_count = 2
			hive_count = 2
			hive_secondary_count = 2
			machine_count = 2
			machine_secondary_count = 2
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/inline_evolved_food_processing_facility
			tier = 2
		}


		inline_script = {
			script = buildings/inline_evolved_aibait
			trigger = ""
		}
	}

	building_tec_biohive_food_processing_complex = {
		base_buildtime = @b3_time
		can_build = no
		position_priority = 210		# Basic boost
		ai_estimate_without_unemployment = yes

		category = resource

		prerequisites = {
			"tech_tec_food_processing_3"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
			NOR = {
				uses_district_set = machine_world
				has_modifier = resort_colony
			}
			has_any_farming_district_or_buildings = no
		}

		allow = {
			has_upgraded_capital = yes
			tec_ai_allow_rare_dependant_building = {
				tier = 3
				rare = volatile_motes
			}
			tec_ai_allow_exotic_dependant_building = {
				exotic = sr_living_metal
			}
		}
		
		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 4
			}

			inline_script = {
				script = buildings/resources/inline_evolved_rare_resource_cost
				tier = 3
				rare = volatile_motes
			}

			inline_script = {
				script = buildings/resources/inline_evolved_ring_production_cost
				rare = volatile_motes
				type = menial
			}

			inline_script = {
				script = buildings/resources/inline_evolved_exotic_resource_cost
				exotic = sr_living_metal
			}
		}

		inline_script = {
			script = modifiers/inline_evolved_farmer_efficiency
			count = 3
			mult = 1
			trigger = ""
		}

		triggered_planet_modifier = {
			planet_livestock_biological_food_produces_add = 3
		}

		inline_script = {
			script = modifiers/inline_evolved_farmer_efficiency
			count = 2
			mult = 1
			trigger = "
				has_ringworld_output_boost = yes
			"
		}

		inline_script = {
			script = jobs/inline_evolved_farmer
			regular_count = 4
			regular_secondary_count = 4
			hive_count = 4
			hive_secondary_count = 4
			machine_count = 4
			machine_secondary_count = 4
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/inline_evolved_food_processing_facility
			tier = 3
		}

		inline_script = {
			script = buildings/inline_evolved_aibait
			trigger = ""
		}
	}
 # /
# /

# Basic production
# ------------- ENERGY -----------------
	building_tec_energrid_1 = {
		base_buildtime = @b2_time
		position_priority = 220		# Basic Production
		base_cap_amount = 5

		category = resource
		
		prerequisites = {
			"tech_tec_energy_plant"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		upgrades = {
			building_tec_energrid_2
		}

		potential = {
			NOT = { has_modifier = resort_colony }
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			tec_ai_destroy_energy_building = no
		}

		allow = {
			tec_ai_allow_energy_building = yes
		}


		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 1
			}
		}

		inline_script = {
			script = jobs/inline_evolved_technician
			regular_count = 2
			regular_secondary_count = 2
			hive_count = 2
			hive_secondary_count = 2
			machine_count = 2
			machine_secondary_count = 2
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/inline_evolved_tec_energrid
			tier = 1
		}
	}

	building_tec_energrid_2 = {
		base_buildtime = @b3_time
		can_build = no
		position_priority = 220		# Basic Production

		category = resource
		
		prerequisites = {
			"tech_tec_energy_plant_2"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		upgrades = {
			building_tec_energrid_3
		}

		potential = {
			NOT = { has_modifier = resort_colony }
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			tec_ai_destroy_energy_building = no
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 2
			}

			# New production
			inline_script = {
				script = districts/resources/inline_evolved_tec_automation_energy
				trigger = ""
				base = 3
			}
		}

		# overlord_resources = {
		# 	category = planet_requisitioned_energy
		# 	produces = {
		# 		trigger = {
		# 			planet = {
		# 				has_planet_flag = has_energy_requisitorium
		# 			}
		# 		}
		# 		energy = @requisitorium_energy_overlord
		# 	}
		# }

		triggered_desc = {
			text = tec_building_affect_production_menialbuilding
		}
		inline_script = {
			script = jobs/inline_evolved_technician
			regular_count = 3
			regular_secondary_count = 3
			hive_count = 3
			hive_secondary_count = 3
			machine_count = 3
			machine_secondary_count = 3
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/inline_evolved_tec_energrid
			tier = 2
		}

		inline_script = { # tier 2 is inexpensive and provides automated production
			script = buildings/inline_evolved_aibait
			trigger = ""
		}
	}

	building_tec_energrid_3 = {
		base_buildtime = @b4_time
		can_build = no
		position_priority = 220		# Basic Production

		category = resource
		
		prerequisites = {
			"tech_tec_energy_plant_3"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		potential = {
			NOT = { has_modifier = resort_colony }
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			tec_ai_destroy_energy_building = no
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 3
			}

			inline_script = {
				script = buildings/resources/inline_evolved_exotic_resource_cost
				exotic = nanites
			}
			inline_script = {
				script = districts/resources/inline_evolved_tec_automation_energy
				trigger = ""
				base = 6
			}
		}

		# overlord_resources = {
		# 	category = planet_requisitioned_energy
		# 	produces = {
		# 		trigger = {
		# 			planet = {
		# 				has_planet_flag = has_energy_requisitorium
		# 			}
		# 		}
		# 		energy = @requisitorium_energy_overlord
		# 	}
		# }

		triggered_desc = {
			text = tec_building_affect_production_menialbuilding
		}

		inline_script = {
			script = jobs/inline_evolved_technician
			regular_count = 4
			regular_secondary_count = 4
			hive_count = 4
			hive_secondary_count = 4
			machine_count = 4
			machine_secondary_count = 4
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/inline_evolved_tec_energrid
			tier = 3
		}
	}
# /
# ------------- MINERALS -----------------
	building_tec_stripmine_1 = {
		base_buildtime = @b2_time
		position_priority = 220		# Basic Production
		base_cap_amount = 5

		category = resource
		
		desc = {
			text = building_tec_stripmine_1_desc
			trigger = {
				NOR = {
					uses_habitat_capitals = yes
					habitable_structure = yes
					tec_is_arcology = yes
				}
			}
		}
		desc = {
			text = building_tec_stripmine_1_hab_desc
			trigger = {
				OR = {
					uses_habitat_capitals = yes
					habitable_structure = yes
					tec_is_arcology = yes
				}
			}
		}

		prerequisites = {
			"tech_tec_mining_array"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		upgrades = {
			building_tec_stripmine_2
		}

		potential = {
			NOT = { has_modifier = resort_colony }
			OR = {
				AND = {
					habitable_structure = no
					tec_is_arcology = no
				}
				uses_habitat_capitals = yes
			}
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			tec_ai_destroy_minerals_building = no
		}

		allow = {
			tec_ai_allow_minerals_building = yes
		}

		convert_to = {
			building_tec_biohive_mining_1
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 1
			}
		}

		inline_script = {
			script = jobs/inline_evolved_miner
			regular_count = 2
			regular_secondary_count = 2
			hive_count = 2
			hive_secondary_count = 2
			machine_count = 2
			machine_secondary_count = 2
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/inline_evolved_tec_energrid
			tier = 1
		}
	}

	building_tec_stripmine_2 = {
		base_buildtime = @b3_time
		can_build = no
		position_priority = 220		# Basic Production

		category = resource
		
		desc = {
			text = building_tec_stripmine_2_desc
			trigger = {
				NOR = {
					uses_habitat_capitals = yes
					habitable_structure = yes
					tec_is_arcology = yes
				}
			}
		}
		desc = {
			text = building_tec_stripmine_2_hab_desc
			trigger = {
				OR = {
					uses_habitat_capitals = yes
					habitable_structure = yes
					tec_is_arcology = yes
				}
			}
		}

		prerequisites = {
			"tech_tec_mining_array_2"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		upgrades = {
			building_tec_stripmine_3
		}

		potential = {
			NOT = { has_modifier = resort_colony }
			OR = {
				AND = {
					habitable_structure = no
					tec_is_arcology = no
				}
				uses_habitat_capitals = yes
			}
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			
			tec_ai_destroy_minerals_building = no
		}

		convert_to = {
			building_tec_biohive_mining_2
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 2
			}

			inline_script = {
				script = districts/resources/inline_evolved_tec_automation_minerals
				trigger = ""
				base = 2
			}
		}

		# overlord_resources = {
		# 	category = planet_requisitioned_minerals
		# 	produces = {
		# 		trigger = {
		# 			planet = {
		# 				has_planet_flag = has_material_requisitorium
		# 			}
		# 		}
		# 		minerals = @requisitorium_minerals_overlord
		# 	}
		# }
		

		triggered_desc = {
			text = tec_building_affect_production_menialbuilding
		}

		inline_script = {
			script = jobs/inline_evolved_miner
			regular_count = 3
			regular_secondary_count = 3
			hive_count = 3
			hive_secondary_count = 3
			machine_count = 3
			machine_secondary_count = 3
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/inline_evolved_tec_energrid
			tier = 2
		}

		inline_script = { # tier 2 is inexpensive and provides automated production
			script = buildings/inline_evolved_aibait
			trigger = ""
		}
	}

	building_tec_stripmine_3 = {
		base_buildtime = @b4_time
		can_build = no
		position_priority = 220		# Basic Production

		category = resource
		
		desc = {
			text = building_tec_stripmine_3_desc
			trigger = {
				NOR = {
					uses_habitat_capitals = yes
					habitable_structure = yes
					tec_is_arcology = yes
				}
			}
		}
		desc = {
			text = building_tec_stripmine_3_hab_desc
			trigger = {
				OR = {
					uses_habitat_capitals = yes
					habitable_structure = yes
					tec_is_arcology = yes
				}
			}
		}
			
		prerequisites = {
			"tech_tec_mining_array_3"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		potential = {
			NOT = { has_modifier = resort_colony }
			OR = {
				AND = {
					habitable_structure = no
					tec_is_arcology = no
				}
				uses_habitat_capitals = yes
			}
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			
			tec_ai_destroy_minerals_building = no
		}

		convert_to = {
			building_tec_biohive_mining_3
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 3
			}

			inline_script = {
				script = buildings/resources/inline_evolved_exotic_resource_cost
				exotic = nanites
			}
			
			inline_script = {
				script = districts/resources/inline_evolved_tec_automation_minerals
				trigger = ""
				base = 4
			}
		}

		# overlord_resources = {
		# 	category = planet_requisitioned_minerals
		# 	produces = {
		# 		trigger = {
		# 			planet = {
		# 				has_planet_flag = has_material_requisitorium
		# 			}
		# 		}
		# 		minerals = @requisitorium_minerals_overlord
		# 	}
		# }

		triggered_desc = {
			text = tec_building_affect_production_menialbuilding
		}

		inline_script = {
			script = jobs/inline_evolved_miner
			regular_count = 4
			regular_secondary_count = 4
			hive_count = 4
			hive_secondary_count = 4
			machine_count = 4
			machine_secondary_count = 4
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/inline_evolved_tec_energrid
			tier = 3
		}
	}
# /
	building_tec_biohive_mining_1 = {
		base_buildtime = @b2_time
		position_priority = 220		# Basic Production
		base_cap_amount = 5

		category = resource
		
		desc = {
			text = building_tec_biohive_mining_1_desc
			trigger = {
				NOR = {
					uses_habitat_capitals = yes
					habitable_structure = yes
					tec_is_arcology = yes
				}
			}
		}
		desc = {
			text = building_tec_biohive_mining_1_hab_desc
			trigger = {
				OR = {
					uses_habitat_capitals = yes
					habitable_structure = yes
					tec_is_arcology = yes
				}
			}
		}

		prerequisites = {
			"tech_tec_mining_array"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		upgrades = {
			building_tec_biohive_mining_2
		}

		potential = {
			NOT = { has_modifier = resort_colony }
			OR = {
				AND = {
					habitable_structure = no
					tec_is_arcology = no
				}
				uses_habitat_capitals = yes
			}
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
			
			tec_ai_destroy_minerals_building = no
		}

		allow = {
			tec_ai_allow_minerals_building = yes
		}

		convert_to = {
			building_tec_stripmine_1
		}

		resources = {
			category = planet_buildings
			cost = {
				food = @b1_half_minerals
				minerals = @b1_half_minerals
			}
			upkeep = {
				energy = @b1_upkeep
			}
			cost = {
				trigger = {
					owner = { tec_is_bioarch_empire = yes }
				}
				minerals = @b1_minus_minerals
				food = @b1_half_minerals
			}

			#Energy
				produces = {
					energy = 5
				}

				produces = {
					trigger = {
						owner = {
							has_technology = tech_power_plant_2
						}
					}
					energy = 1
				}
				produces = {
					trigger = {
						owner = {
							has_technology = tech_power_plant_3
						}
					}
					energy = 1
				}
				produces = {
					trigger = {
						owner = {
							has_technology = tech_power_plant_4
						}
					}
					energy = 1
				}
			# /
			
			# Minerals
				produces = {
					minerals = 5
				}

				produces = {
					trigger = {
						owner = {
							has_technology = tech_mining_1
						}
					}
					minerals = 1
				}
				produces = {
					trigger = {
						owner = {
							has_technology = tech_mining_2
						}
					}
					minerals = 1
				}
				produces = {
					trigger = {
						owner = {
							has_technology = tech_mining_3
						}
					}
					minerals = 1
				}
			# /
		}

		triggered_planet_modifier = {	# Gestalt
			potential = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
				planet = {
					has_mining_designation = no
					has_generator_designation = no
				}
			}
			modifier = {
				job_mining_drone_add = 1
				job_technician_drone_add = 1
			}
		}
		triggered_planet_modifier = {	# Gestalt
			potential = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
				planet = {
					has_mining_designation = yes
				}
			}
			modifier = {
				job_mining_drone_add = 2
			}
		}
		triggered_planet_modifier = {	# Gestalt
			potential = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
				planet = {
					has_generator_designation = yes
				}
			}
			modifier = {
				job_technician_drone_add = 2
			}
		}
		triggered_desc = {
			trigger = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
				planet = {
					OR = {
						AND = {
							has_mining_designation = no
							has_generator_designation = no
						}
						has_mining_designation = yes
					}
				}
			}
			text = job_mining_drone_effect_desc
		}
		triggered_desc = {
			trigger = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
				planet = {
					OR = {
						AND = {
							has_mining_designation = no
							has_generator_designation = no
						}
						has_generator_designation = yes
					}
				}
			}
			text = job_technician_drone_effect_desc
		}
	}

	building_tec_biohive_mining_2 = {
		base_buildtime = @b3_time
		can_build = no
		position_priority = 220		# Basic Production

		category = resource
		
		desc = {
			text = building_tec_biohive_mining_2_desc
			trigger = {
				NOR = {
					uses_habitat_capitals = yes
					habitable_structure = yes
					tec_is_arcology = yes
				}
			}
		}
		desc = {
			text = building_tec_biohive_mining_2_hab_desc
			trigger = {
				OR = {
					uses_habitat_capitals = yes
					habitable_structure = yes
					tec_is_arcology = yes
				}
			}
		}

		prerequisites = {
			"tech_tec_mining_array_2"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		upgrades = {
			building_tec_biohive_mining_3
		}

		potential = {
			NOT = { has_modifier = resort_colony }
			OR = {
				AND = {
					habitable_structure = no
					tec_is_arcology = no
				}
				uses_habitat_capitals = yes
			}
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
			tec_ai_destroy_minerals_building = no
		}

		convert_to = {
			building_tec_stripmine_2
		}

		resources = {
			category = planet_buildings
			cost = {
				food = @b2_half_minerals
				minerals = @b2_half_minerals
			}
			upkeep = {
				energy = @b2_upkeep
			}
			cost = {
				trigger = {
					owner = { tec_is_bioarch_empire = yes }
				}
				minerals = @b2_minus_minerals
				food = @b2_half_minerals
			}

			#Energy
				produces = {
					energy = 10
				}

				produces = {
					trigger = {
						owner = {
							has_technology = tech_power_plant_2
						}
					}
					energy = 2
				}
				produces = {
					trigger = {
						owner = {
							has_technology = tech_power_plant_3
						}
					}
					energy = 2
				}
				produces = {
					trigger = {
						owner = {
							has_technology = tech_power_plant_4
						}
					}
					energy = 2
				}
			# /
			
			# Minerals
				produces = {
					minerals = 10
				}

				produces = {
					trigger = {
						owner = {
							has_technology = tech_mining_1
						}
					}
					minerals = 2
				}
				produces = {
					trigger = {
						owner = {
							has_technology = tech_mining_2
						}
					}
					minerals = 2
				}
				produces = {
					trigger = {
						owner = {
							has_technology = tech_mining_3
						}
					}
					minerals = 2
				}
			# /
		}

		triggered_desc = {
			text = tec_building_affect_production_menialbuilding
		}

		triggered_planet_modifier = {	# Gestalt
			potential = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
				planet = {
					has_mining_designation = no
					has_generator_designation = no
				}
			}
			modifier = {
				job_mining_drone_add = 2
				job_technician_drone_add = 2
			}
		}
		triggered_planet_modifier = {	# Gestalt
			potential = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
				planet = {
					has_mining_designation = yes
				}
			}
			modifier = {
				job_mining_drone_add = 4
			}
		}
		triggered_planet_modifier = {	# Gestalt
			potential = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
				planet = {
					has_generator_designation = yes
				}
			}
			modifier = {
				job_technician_drone_add = 4
			}
		}
		triggered_desc = {
			trigger = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
				planet = {
					OR = {
						AND = {
							has_mining_designation = no
							has_generator_designation = no
						}
						has_mining_designation = yes
					}
				}
			}
			text = job_mining_drone_effect_desc
		}
		triggered_desc = {
			trigger = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
				planet = {
					OR = {
						AND = {
							has_mining_designation = no
							has_generator_designation = no
						}
						has_generator_designation = yes
					}
				}
			}
			text = job_technician_drone_effect_desc
		}

		inline_script = { # tier 2 is inexpensive and provides automated production
			script = buildings/inline_evolved_aibait
			trigger = ""
		}
	}

	building_tec_biohive_mining_3 = {
		base_buildtime = @b4_time
		can_build = no
		position_priority = 220		# Basic Production

		category = resource
		
		desc = {
			text = building_tec_biohive_mining_3_desc
			trigger = {
				NOR = {
					uses_habitat_capitals = yes
					habitable_structure = yes
					tec_is_arcology = yes
				}
			}
		}
		desc = {
			text = building_tec_biohive_mining_3_hab_desc
			trigger = {
				OR = {
					uses_habitat_capitals = yes
					habitable_structure = yes
					tec_is_arcology = yes
				}
			}
		}
			
		prerequisites = {
			"tech_tec_mining_array_3"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		potential = {
			NOT = { has_modifier = resort_colony }
			OR = {
				AND = {
					habitable_structure = no
					tec_is_arcology = no
				}
				uses_habitat_capitals = yes
			}
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
			tec_ai_destroy_minerals_building = no
		}

		convert_to = {
			building_tec_stripmine_3
		}

		resources = {
			category = planet_buildings
			cost = {
				food = @b3_half_minerals
				minerals = @b3_half_minerals
				#rare_crystals = @b2_rare_cost
				nanites = 25
			}
			upkeep = {
				energy = @b3_upkeep
				#rare_crystals = @b2_rare_upkeep
				nanites = 1
			}
			cost = {
				trigger = {
					owner = { tec_is_bioarch_empire = yes }
				}
				minerals = @b3_minus_minerals
				food = @b3_half_minerals
			}

			#Energy
				produces = {
					energy = 15
				}

				produces = {
					trigger = {
						owner = {
							has_technology = tech_power_plant_2
						}
					}
					energy = 5
				}
				produces = {
					trigger = {
						owner = {
							has_technology = tech_power_plant_3
						}
					}
					energy = 5
				}
				produces = {
					trigger = {
						owner = {
							has_technology = tech_power_plant_4
						}
					}
					energy = 5
				}
			# /
			
			# Minerals
				produces = {
					minerals = 15
				}

				produces = {
					trigger = {
						owner = {
							has_technology = tech_mining_1
						}
					}
					minerals = 5
				}
				produces = {
					trigger = {
						owner = {
							has_technology = tech_mining_2
						}
					}
					minerals = 5
				}
				produces = {
					trigger = {
						owner = {
							has_technology = tech_mining_3
						}
					}
					minerals = 5
				}
			# /
		}

		triggered_desc = {
			text = tec_building_affect_production_menialbuilding
		}

		triggered_planet_modifier = {	# Gestalt
			potential = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
				planet = {
					has_mining_designation = no
					has_generator_designation = no
				}
			}
			modifier = {
				job_mining_drone_add = 3
				job_technician_drone_add = 3
			}
		}
		triggered_planet_modifier = {	# Gestalt
			potential = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
				planet = {
					has_mining_designation = yes
				}
			}
			modifier = {
				job_mining_drone_add = 6
			}
		}
		triggered_planet_modifier = {	# Gestalt
			potential = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
				planet = {
					has_generator_designation = yes
				}
			}
			modifier = {
				job_technician_drone_add = 6
			}
		}
		triggered_desc = {
			trigger = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
				planet = {
					OR = {
						AND = {
							has_mining_designation = no
							has_generator_designation = no
						}
						has_mining_designation = yes
					}
				}
			}
			text = job_mining_drone_effect_desc
		}
		triggered_desc = {
			trigger = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
				planet = {
					OR = {
						AND = {
							has_mining_designation = no
							has_generator_designation = no
						}
						has_generator_designation = yes
					}
				}
			}
			text = job_technician_drone_effect_desc
		}

	}
# /
# ------------- FOOD -----------------
 # Regular
	building_hydroponics_farm = {
		base_buildtime = @b1_time
		position_priority = 220		# Basic Production
		base_cap_amount = 5

		category = resource
		
		prerequisites = {
			"tech_hydroponics"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		upgrades = {
			building_hydroponics_farm_2
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			if = {
				limit = {
					owner = {
						is_ai = yes
					}
				}
				owner = {
					country_uses_food = yes
				}
			}
			NOT = { uses_district_set = machine_world }
			NOT = { has_modifier = resort_colony }
			tec_ai_destroy_food_building = no
		}
		
		allow = {
			tec_ai_allow_food_building = yes
		}

		convert_to = {
			building_tec_biomass_farm_1
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 1
			}
		}

		# Modifiers
			triggered_planet_modifier = {
				potential = {
					tec_is_habitat = yes
				}
				district_tec_hab_food_max = 2
			}
		# /

		# Jobs
			inline_script = {
				script = jobs/inline_evolved_farmer
				regular_count = 2
				regular_secondary_count = 2
				hive_count = 2
				hive_secondary_count = 2
				machine_count = 2
				machine_secondary_count = 2
				mult = 1
				display = with_desc
				trigger = ""
			}
		# /

		inline_script = {
			script = buildings/effects/type/inline_evolved_hydroponics_farm
			tier = 1
		}
	}

	building_hydroponics_farm_2 = {
		base_buildtime = @b3_time
		can_build = no
		position_priority = 220		# Basic Production

		category = resource

		prerequisites = {
			"tech_tec_hydroponics_2"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}
		
		upgrades = {
			building_hydroponics_farm_3
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			if = {
				limit = {
					owner = {
						is_ai = yes
					}
				}
				owner = {
					country_uses_food = yes
				}
			}
			NOT = { uses_district_set = machine_world }
			NOT = { has_modifier = resort_colony }
			tec_ai_destroy_food_building = no
		}

		convert_to = {
			building_tec_biomass_farm_2
		}


		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 2
			}
			
			inline_script = {
				script = districts/resources/inline_evolved_tec_automation_food
				trigger = ""
				base = 3
			}
		}

		# overlord_resources = {
		# 	category = planet_requisitioned_food
		# 	produces = {
		# 		trigger = {
		# 			planet = {
		# 				has_planet_flag = has_produce_requisitorium
		# 			}
		# 		}
		# 		food = @requisitorium_food_overlord
		# 	}
		# }


		triggered_desc = {
			text = tec_building_affect_production_menialbuilding
		}

		# Modifiers
			triggered_planet_modifier = {
				potential = {
					tec_is_habitat = yes
				}
				district_tec_hab_food_max = 3
			}
		# /
		# Jobs
			inline_script = {
				script = jobs/inline_evolved_farmer
				regular_count = 3
				regular_secondary_count = 3
				hive_count = 3
				hive_secondary_count = 3
				machine_count = 3
				machine_secondary_count = 3
				mult = 1
				display = with_desc
				trigger = ""
			}
		# /

		inline_script = {
			script = buildings/effects/type/inline_evolved_hydroponics_farm
			tier = 2
		}

		inline_script = { # tier 2 is inexpensive and provides automated production
			script = buildings/inline_evolved_aibait
			trigger = ""
		}
	}

	building_hydroponics_farm_3 = {
		base_buildtime = @b4_time
		can_build = no
		position_priority = 220		# Basic Production

		category = resource

		prerequisites = {
			"tech_tec_hydroponics_3"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}
		
		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			if = {
				limit = {
					owner = {
						is_ai = yes
					}
				}
				owner = {
					country_uses_food = yes
				}
			}
			NOT = { uses_district_set = machine_world }
			NOT = { has_modifier = resort_colony }
			tec_ai_destroy_food_building = no
		}

		convert_to = {
			building_tec_biomass_farm_3
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 3
			}

			inline_script = {
				script = buildings/resources/inline_evolved_exotic_resource_cost
				exotic = nanites
			}
			
			inline_script = {
				script = districts/resources/inline_evolved_tec_automation_food
				trigger = ""
				base = 6
			}
		}

		# overlord_resources = {
		# 	category = planet_requisitioned_food
		# 	produces = {
		# 		trigger = {
		# 			planet = {
		# 				has_planet_flag = has_produce_requisitorium
		# 			}
		# 		}
		# 		food = @requisitorium_food_overlord
		# 	}
		# }

		triggered_desc = {
			text = tec_building_affect_production_menialbuilding
		}

		# Modifiers
			triggered_planet_modifier = {
				potential = {
					tec_is_habitat = yes
				}
				district_tec_hab_food_max = 4
			}
		# /
		# Jobs
			inline_script = {
				script = jobs/inline_evolved_farmer
				regular_count = 4
				regular_secondary_count = 4
				hive_count = 4
				hive_secondary_count = 4
				machine_count = 4
				machine_secondary_count = 4
				mult = 1
				display = with_desc
				trigger = ""
			}
		# /

		inline_script = {
			script = buildings/effects/type/inline_evolved_hydroponics_farm
			tier = 3
		}
	}
 # /
 # Biohive
	building_tec_biomass_farm_1 = {
		base_buildtime = @b1_time
		position_priority = 220		# Basic Production
		base_cap_amount = 5

		category = resource
		
		prerequisites = {
			"tech_hydroponics"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		upgrades = {
			building_hydroponics_farm_2
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
			NOT = { uses_district_set = machine_world }
		}

		convert_to = {
			building_tec_biomass_farm_1
		}

		resources = {
			category = planet_buildings
			cost = {
				food = @b1_half_minerals
				minerals = @b1_half_minerals
			}
			upkeep = {
				energy = @b1_upkeep 
			}
			cost = {
				trigger = {
					owner = { tec_is_bioarch_empire = yes }
				}
				minerals = @b1_minus_minerals
				food = @b1_half_minerals
			}
		}

		triggered_planet_modifier = {
			potential = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
			}
			modifier = {
				job_tec_biomass_drone_add = @b1_jobs
			}
		}
		triggered_desc = {
			trigger = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
			}
			text = job_tec_biomass_drone_effect_desc
		}

		inline_script = {
			script = buildings/effects/type/inline_evolved_hydroponics_farm
			tier = 1
		}
	}

	building_tec_biomass_farm_2 = {
		base_buildtime = @b3_time
		can_build = no
		position_priority = 220		# Basic Production

		category = resource

		prerequisites = {
			"tech_tec_hydroponics_2"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}
		
		upgrades = {
			building_hydroponics_farm_3
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
			NOT = { uses_district_set = machine_world }
		}

		convert_to = {
			building_tec_biomass_farm_2
		}


		resources = {
			category = planet_buildings
			cost = {
				food = @b2_half_minerals
				minerals = @b2_half_minerals
			}
			upkeep = {
				energy = @b2_upkeep 
			}
			cost = {
				trigger = {
					owner = { tec_is_bioarch_empire = yes }
				}
				minerals = @b2_minus_minerals
				food = @b2_half_minerals
			}

			# New production
			produces = {
				food = 5
			}

			produces = {
				trigger = {
					planet = {
						has_active_building = building_food_processing_facility
					}
				}
				food = 1
			}
			produces = {
				trigger = {
					planet = {
						has_active_building = building_food_processing_center
					}
				}
				food = 2
			}
			produces = {
				trigger = {
					planet = {
						has_active_building = building_food_processing_complex
					}
				}
				food = 3
			}

			produces = {
				trigger = {
					owner = {
						has_technology = tech_eco_simulation
					}
				}
				food = 1
			}
			produces = {
				trigger = {
					owner = {
						has_technology = tech_gene_crops
					}
				}
				food = 1
			}
			produces = {
				trigger = {
					owner = {
						has_technology = tech_nano_vitality_crops
					}
				}
				food = 1
			}
			produces = {
				trigger = {
					owner = {
						has_technology = tech_nutrient_replication
					}
				}
				food = 1
			}
		}

		triggered_desc = {
			text = tec_building_affect_production_menialbuilding
		}
		
		triggered_planet_modifier = {	# Gestalt
			potential = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
			}
			modifier = {
				job_tec_biomass_drone_add = 3
			}
		}
		triggered_desc = {
			trigger = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
			}
			text = job_tec_biomass_drone_effect_desc
		}


		inline_script = {
			script = buildings/effects/type/inline_evolved_hydroponics_farm
			tier = 2
		}

		inline_script = { # tier 2 is inexpensive and provides automated production
			script = buildings/inline_evolved_aibait
			trigger = ""
		}
	}

	building_tec_biomass_farm_3 = {
		base_buildtime = @b4_time
		can_build = no
		position_priority = 220		# Basic Production

		category = resource

		prerequisites = {
			"tech_tec_hydroponics_3"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}
		
		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
			NOT = { uses_district_set = machine_world }
		}

		convert_to = {
			building_tec_biomass_farm_3
		}

		resources = {
			category = planet_buildings
			cost = {
				food = @b3_half_minerals
				minerals = @b3_half_minerals
				#volatile_motes = @b2_rare_cost
				nanites = 25
			}
			upkeep = {
				energy = @b3_upkeep
				#volatile_motes = @b2_rare_upkeep
				nanites = 1
			}
			cost = {
				trigger = {
					owner = { tec_is_bioarch_empire = yes }
				}
				minerals = @b3_minus_minerals
				food = @b3_half_minerals
			}

			# New production
			produces = {
				food = 20
			}

			produces = {
				trigger = {
					planet = {
						has_active_building = building_food_processing_facility
					}
				}
				food = 1
			}
			produces = {
				trigger = {
					planet = {
						has_active_building = building_food_processing_center
					}
				}
				food = 2
			}
			produces = {
				trigger = {
					planet = {
						has_active_building = building_food_processing_complex
					}
				}
				food = 3
			}

			produces = {
				trigger = {
					owner = {
						has_technology = tech_eco_simulation
					}
				}
				food = 2
			}
			produces = {
				trigger = {
					owner = {
						has_technology = tech_gene_crops
					}
				}
				food = 2
			}
			produces = {
				trigger = {
					owner = {
						has_technology = tech_nano_vitality_crops
					}
				}
				food = 2
			}
			produces = {
				trigger = {
					owner = {
						has_technology = tech_nutrient_replication
					}
				}
				food = 1
			}
		}

		triggered_desc = {
			text = tec_building_affect_production_menialbuilding
		}
		
		triggered_planet_modifier = {	# Gestalt
			potential = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
			}
			modifier = {
				job_tec_biomass_drone_add = 4
			}
		}
		triggered_desc = {	# Gestalt
			trigger = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
			}
			text = job_tec_biomass_drone_effect_desc
		}

		inline_script = {
			script = buildings/effects/type/inline_evolved_hydroponics_farm
			tier = 3
		}
	}
 # /
	## /
	## MISC
	## -AND = {
	#				is_planet_class = pc_habitat
	#				check_modifier_value = {
	#					modifier = district_hab_mining_max
	#					value > 0
	#				}
	#			}
			
# ------------- STORAGE -----------------
	building_resource_silo = {
		base_buildtime = @b1_time
		position_priority = 400		# Other/Misc

		category = resource

		prerequisites = {
			"tech_basic_industry"
		}

		potential = {
			NOR = {
				has_modifier = resort_colony
				has_modifier = slave_colony
				has_modifier = crucible_colony
			}
		}

		allow = {
			tec_ai_allow_silo_building = yes
		}

		upgrades = {
			building_tec_resource_silo_2
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 1
			}
		}

		country_modifier = {
			country_resource_max_add = 5000
		}

		triggered_country_modifier = {
			potential = {
				exists = owner
				owner = {
					has_technology = tech_construction_templates
				}
			}
			country_resource_max_add = 5000
		}

		inline_script = {
			script = jobs/inline_evolved_clerk
			count = 1
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/inline_evolved_maintenance_drone
			count = 1
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/inline_evolved_resource_silo
			tier = 1
		}
	}

	building_tec_resource_silo_2 = {
		base_buildtime = @b2_time
		can_build = no
		position_priority = 400		# Other/Misc

		category = resource

		prerequisites = {
			"tech_housing_1"
		}

		potential = {
			NOR = {
				has_modifier = resort_colony
				has_modifier = slave_colony
				has_modifier = crucible_colony
			}
		}

		upgrades = {
			building_tec_resource_silo_3
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 2
			}
		}

		country_modifier = {
			country_resource_max_add = 10000
		}

		triggered_country_modifier = {
			potential = {
				exists = owner
				owner = {
					has_technology = tech_construction_templates
				}
			}
			country_resource_max_add = 5000
		}
		
		inline_script = {
			script = jobs/inline_evolved_clerk
			count = 2
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/inline_evolved_maintenance_drone
			count = 2
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/inline_evolved_resource_silo
			tier = 2
		}
	}

	building_tec_resource_silo_3 = {
		base_buildtime = @b3_time
		can_build = no
		position_priority = 400		# Other/Misc

		category = resource

		prerequisites = {
			"tech_housing_2"
		}

		potential = {
			NOR = {
				has_modifier = resort_colony
				has_modifier = slave_colony
				has_modifier = crucible_colony
			}
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 3
			}
		}

		country_modifier = {
			country_resource_max_add = 15000
		}

		triggered_country_modifier = {
			potential = {
				exists = owner
				owner = {
					has_technology = tech_global_production_strategy
				}
			}
			country_resource_max_add = 5000
		}

		inline_script = {
			script = jobs/inline_evolved_clerk
			count = 4
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/inline_evolved_maintenance_drone
			count = 4
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/inline_evolved_resource_silo
			tier = 3
		}
	}
# /
# ------------- HOARDERS -----------------

@tec_vault_scale = 0.001
@tec_vault_advanced = 2
@tec_vault_strategic = 4

	building_tec_vault_of_plenty = {
		base_buildtime = @b3_time
		position_priority = 30		# Other/Misc
		ai_estimate_without_unemployment = yes

		empire_limit = 1

		category = resource

		potential = {
			owner = {
				tec_is_hoarder_empire = yes
			}
		}

		destroy_trigger = {
			always = no
		}

		on_destroy = {
			tec_hoarders_recover_resource = { RESOURCE = minerals }
			tec_hoarders_recover_resource = { RESOURCE = food }
			tec_hoarders_recover_resource = { RESOURCE = alloys }
			tec_hoarders_recover_resource = { RESOURCE = consumer_goods }
			tec_hoarders_recover_resource = { RESOURCE = rare_crystals }
			tec_hoarders_recover_resource = { RESOURCE = exotic_gases }
			tec_hoarders_recover_resource = { RESOURCE = volatile_motes }
			tec_hoarders_recover_resource = { RESOURCE = minor_artifacts }

			remove_building = building_tec_vault_of_acquisition
			remove_building = building_tec_vault_of_unity
			remove_building = building_tec_vault_of_wealth

			create_message = {
				type = MESSAGE_TEC_VAULT_DESTROYED
				localization = MESSAGE_TEC_VAULT_DESTROYED
				days = 30
				target = planet
				variable = {
					type = name
					localization = PLANET
					scope = planet
				}
			}
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 3
			}
			upkeep = {
				energy = 5
			}
		}

		country_modifier = {
			country_resource_max_add = 10000
		}

		triggered_country_modifier = {
			potential = {
				exists = owner
				owner = {
					has_technology = tech_construction_templates
				}
			}
			country_resource_max_add = 10000
		}

		inline_script = {
			script = jobs/inline_evolved_bureaucrat
			count = 2
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/inline_evolved_clerk
			count = 2
			mult = 1
			display = with_desc
			trigger = ""
		}
		
		inline_script = {
			script = jobs/inline_evolved_synapse
			count = 2
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/inline_evolved_coordinator
			count = 2
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/inline_evolved_maintenance_drone
			count = 2
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/inline_evolved_tec_hoarder
			count = 2
		}

		triggered_desc = {
			trigger = {
				owner = {
					tec_is_hoarder_empire = no
				}
			}
			text = building_tec_vault_of_plenty_no_deposit_effect_desc
		}

		triggered_desc = {
			text = building_tec_vault_of_plenty_effect_desc
		}


		inline_script = {
			script = buildings/inline_evolved_aibait
			trigger = "
				is_capital = yes
			"
		}
	}

	building_tec_vault_of_acquisition = {
		base_buildtime = @b3_time
		position_priority = 30		# Other/Misc
		ai_estimate_without_unemployment = yes

		empire_limit = 1

		category = resource

		potential = {
			owner = {
				tec_is_hoarder_empire = yes
			}
		}

		allow = {
			has_building = building_tec_vault_of_plenty
		}

		destroy_trigger = {
			NOT = { has_building = building_tec_vault_of_plenty }
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 3
			}
			upkeep = {
				energy = 5
			}
			produces = {
				minerals = @tec_vault_scale
				multiplier = value:tec_vault_scale|VAR|tec_minerals_stockpile|
			}
			produces = {
				food = @tec_vault_scale
				multiplier = value:tec_vault_scale|VAR|tec_food_stockpile|
			}
			produces = {
				alloys = @tec_vault_scale
				multiplier = value:tec_vault_scale|VAR|tec_alloys_stockpile|
			}
			produces = {
				consumer_goods = @tec_vault_scale
				multiplier = value:tec_vault_scale|VAR|tec_consumer_goods_stockpile|
			}
			produces = {
				rare_crystals = @tec_vault_scale
				multiplier = value:tec_vault_scale|VAR|tec_rare_crystals_stockpile|
			}
			produces = {
				exotic_gases = @tec_vault_scale
				multiplier = value:tec_vault_scale|VAR|tec_exotic_gases_stockpile|
			}
			produces = {
				volatile_motes = @tec_vault_scale
				multiplier = value:tec_vault_scale|VAR|tec_volatile_motes_stockpile|
			}
			produces = {
				minor_artifacts = @[ tec_vault_scale * 0.5]
				multiplier = value:tec_vault_scale|VAR|tec_minor_artifacts_stockpile|
			}
		}

		country_modifier = {
			country_resource_max_add = 5000
		}

		triggered_country_modifier = {
			potential = {
				exists = owner
				owner = {
					has_technology = tech_construction_templates
				}
			}
			country_resource_max_add = 5000
		}

		inline_script = {
			script = jobs/inline_evolved_politician
			count = 1
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/inline_evolved_bureaucrat
			count = 1
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/inline_evolved_synapse
			count = 2
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/inline_evolved_coordinator
			count = 2
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/inline_evolved_tec_hoarder
			count = 1
		}

		triggered_desc = {
			trigger = {
				owner = {
					tec_is_hoarder_empire = no
				}
			}
			text = building_tec_vault_not_hoarder_effect_desc
		}

		triggered_desc = {
			text = building_tec_vault_of_acquisition_effect_desc
		}

		inline_script = {
			script = buildings/inline_evolved_aibait
			trigger = "
				is_capital = yes
			"
		}
	}


	building_tec_vault_of_unity = {
		base_buildtime = @b3_time
		position_priority = 30		# Other/Misc
		ai_estimate_without_unemployment = yes

		empire_limit = 1

		category = resource

		prerequisites = {
			"tech_hypercomms_forum"
		}

		show_tech_unlock_if = {
			tec_is_hoarder_empire = yes
		}

		potential = {
			owner = {
				tec_is_hoarder_empire = yes
			}
		}

		allow = {
			has_building = building_tec_vault_of_plenty
			tec_ai_allow_rare_dependant_building = {
				tier = 3
				rare = rare_crystals
			}
		}

		destroy_trigger = {
			NOT = { has_building = building_tec_vault_of_plenty }
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 4
			}
			upkeep = {
				energy = 10
			}
			inline_script = {
				script = buildings/resources/inline_evolved_rare_resource_cost
				tier = 3
				rare = rare_crystals
			}
			produces = {
				unity = @tec_vault_scale
				multiplier = value:tec_vault_scale|VAR|tec_minerals_stockpile|
			}
			produces = {
				unity = @tec_vault_scale
				multiplier = value:tec_vault_scale|VAR|tec_food_stockpile|
			}
			produces = {
				unity = @[ tec_vault_scale * tec_vault_advanced ]
				multiplier = value:tec_vault_scale|VAR|tec_alloys_stockpile|
			}
			produces = {
				unity = @[ tec_vault_scale * tec_vault_advanced ]
				multiplier = value:tec_vault_scale|VAR|tec_consumer_goods_stockpile|
			}
			produces = {
				unity = @[ tec_vault_scale * tec_vault_strategic ]
				multiplier = value:tec_vault_scale|VAR|tec_rare_crystals_stockpile|
			}
			produces = {
				unity = @[ tec_vault_scale * tec_vault_strategic ]
				multiplier = value:tec_vault_scale|VAR|tec_exotic_gases_stockpile|
			}
			produces = {
				unity = @[ tec_vault_scale * tec_vault_strategic ]
				multiplier = value:tec_vault_scale|VAR|tec_volatile_motes_stockpile|
			}
			produces = {
				unity = @[ tec_vault_scale * tec_vault_strategic ]
				multiplier = value:tec_vault_scale|VAR|tec_minor_artifacts_stockpile|
			}
		}

		country_modifier = {
			country_resource_max_add = 5000
		}

		triggered_country_modifier = {
			potential = {
				exists = owner
				owner = {
					has_technology = tech_construction_templates
				}
			}
			country_resource_max_add = 5000
		}

		inline_script = {
			script = jobs/inline_evolved_culture_worker
			count = 2
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/inline_evolved_evaluator
			count = 2
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/inline_evolved_tec_hoarder
			count = 1
		}

		triggered_desc = {
			trigger = {
				owner = {
					tec_is_hoarder_empire = no
				}
			}
			text = building_tec_vault_not_hoarder_effect_desc
		}

		triggered_desc = {
			text = building_tec_vault_of_unity_effect_desc
		}

		inline_script = {
			script = buildings/inline_evolved_aibait
			trigger = "
				is_capital = yes
			"
		}
	}

	building_tec_vault_of_wealth = {
		base_buildtime = @b4_time
		position_priority = 30		# Other/Misc
		empire_limit = 1
		ai_estimate_without_unemployment = yes

		category = resource

		
		prerequisites = {
			"tech_galactic_markets"
		}

		show_tech_unlock_if = {
			tec_is_hoarder_empire = yes
			tec_uses_trade_value = yes
		}

		potential = {
			owner = {
				tec_is_hoarder_empire = yes
				tec_uses_trade_value = yes
			}
		}

		allow = {
			has_building = building_tec_vault_of_plenty
			tec_ai_allow_rare_dependant_building = {
				tier = 3
				rare = rare_crystals
			}
		}

		destroy_trigger = {
			NOT = { has_building = building_tec_vault_of_plenty }
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 4
			}
			inline_script = {
				script = buildings/resources/inline_evolved_rare_resource_cost
				tier = 3
				rare = rare_crystals
			}
			upkeep = {
				energy = 10
			}
		}

		country_modifier = {
			country_resource_max_add = 5000
		}

		triggered_country_modifier = {
			potential = {
				exists = owner
				owner = {
					has_technology = tech_construction_templates
				}
			}
			country_resource_max_add = 5000
		}

		triggered_planet_modifier = {
			trade_value_add = @tec_vault_scale
			mult = value:tec_vault_scale|VAR|tec_minerals_stockpile|
		}

		triggered_planet_modifier = {
			trade_value_add = @tec_vault_scale
			mult = value:tec_vault_scale|VAR|tec_food_stockpile|
		}

		triggered_planet_modifier = {
			trade_value_add = @[ tec_vault_scale * tec_vault_advanced ]
			mult = value:tec_vault_scale|VAR|tec_alloys_stockpile|
		}

		triggered_planet_modifier = {
			trade_value_add = @[ tec_vault_scale * tec_vault_advanced ]
			mult = value:tec_vault_scale|VAR|tec_consumer_goods_stockpile|
		}

		triggered_planet_modifier = {
			trade_value_add = @[ tec_vault_scale * tec_vault_strategic ]
			mult = value:tec_vault_scale|VAR|tec_rare_crystals_stockpile|
		}

		triggered_planet_modifier = {
			trade_value_add = @[ tec_vault_scale * tec_vault_strategic ]
			mult = value:tec_vault_scale|VAR|tec_exotic_gases_stockpile|
		}

		triggered_planet_modifier = {
			trade_value_add = @[ tec_vault_scale * tec_vault_strategic ]
			mult = value:tec_vault_scale|VAR|tec_volatile_motes_stockpile|
		}

		triggered_planet_modifier = {
			trade_value_add = @[ tec_vault_scale * tec_vault_strategic ]
			mult = value:tec_vault_scale|VAR|tec_minor_artifacts_stockpile|
		}

		inline_script = {
			script = jobs/inline_evolved_merchant
			count = 1
			mult = 1
			display = with_desc
			trigger = "
				exists = owner
				owner = {
					is_regular_empire = yes
				}
			"
		}

		inline_script = {
			script = jobs/inline_evolved_clerk
			count = 1
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = districts/effects/inline_evolved_mercantile_commercial_enterprise
			count = 1
			display = no_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/inline_evolved_job
			job = tec_trade_drone
			count = 2
			mult = 1
			display = with_desc
			trigger = "
				exists = owner
				owner = {
					tec_is_trade_gestalt = yes
				}
			"
		}

		inline_script = {
			script = districts/effects/inline_evolved_tec_mercantile_commercial_enterprise_gestalt
			count = 1
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/inline_evolved_tec_hoarder
			count = 1
		}

		triggered_desc = {
			trigger = {
				owner = {
					tec_is_hoarder_empire = no
				}
			}
			text = building_tec_vault_not_hoarder_effect_desc
		}

		triggered_desc = {
			text = building_tec_vault_of_wealth_effect_desc
		}

		inline_script = {
			script = buildings/inline_evolved_aibait
			trigger = "
				is_capital = yes
			"
		}
	}
# /
# ------------- BIOREACTOR -----------------
# - wip for the future - will be improved

# /
# ------------- DESICCATOR -----------------
	building_tec_machine_anglers_extractor = {
		base_buildtime = @b2_time
		base_cap_amount = 5
		position_priority = 220		# Basic Production
		ai_estimate_without_unemployment = yes

		category = resource

		potential = {
			exists = owner
			owner = {
				is_machine_empire = yes
				tec_is_aquatic_empire = yes
			}
			tec_has_desiccation = no
			NOR = {
				has_modifier = resort_colony 
			}
			tec_allows_desiccation = yes
		}

		destroy_trigger = {
			exists = owner
			OR = {
				owner = {
					OR = {
						is_machine_empire = no
						tec_is_aquatic_empire = no
					}
				}
				tec_has_desiccation = yes
				tec_allows_desiccation = no
			}
		}

		convert_to = {
			building_tec_energrid_1
			building_tec_machine_anglers_extractor_on
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 1
			}

			produces = {
				energy = 1
				multiplier = value:tec_automated_production|BASE|4|ECO_CAT|planet_technician|RESOURCE|energy|REQUISITION|has_energy_requisitorium|REQUISITION_AMOUNT|@requisitorium_energy_reduction|
			}
		}

		# overlord_resources = {
		# 	category = planet_requisitioned_energy
		# 	produces = {
		# 		trigger = {
		# 			planet = {
		# 				has_planet_flag = has_energy_requisitorium
		# 			}
		# 		}
		# 		energy = @requisitorium_energy_overlord
		# 	}
		# }

		triggered_desc = {
			text = tec_building_affect_production_menialbuilding
		}

		inline_script = {
			script = jobs/inline_evolved_technician
			regular_count = 1
			regular_secondary_count = 1
			hive_count = 1
			hive_secondary_count = 1
			machine_count = 1
			machine_secondary_count = 1
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/inline_evolved_technician_secondary
			regular_count = 1
			hive_count = 1
			machine_count = 1
			mult = 1
			display = with_desc
			trigger = ""
		}
	}

	building_tec_machine_anglers_extractor_on = {
		base_buildtime = @b2_time
		base_cap_amount = 5
		position_priority = 220		# Basic Production
		ai_estimate_without_unemployment = yes

		category = resource

		potential = {
			exists = owner
			owner = {
				is_machine_empire = yes
				tec_is_aquatic_empire = yes
			}
			tec_has_desiccation = yes
			NOR = {
				has_modifier = resort_colony
			}
			tec_allows_desiccation = yes
		}

		destroy_trigger = {
			exists = owner
			OR = {
				owner = {
					OR = {
						is_machine_empire = no
						tec_is_aquatic_empire = no
					}
				}
				tec_has_desiccation = no
				tec_allows_desiccation = no
			}
		}

		convert_to = {
			building_tec_energrid_1
			building_tec_machine_anglers_extractor
		}

		triggered_desc = {
			text = tec_building_affect_production_menialbuilding
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 1
			}

			produces = {
				energy = 1
				multiplier = value:tec_automated_production|BASE|6|BASE_VALUE|tec_machine_angler_extractor_base_production|ECO_CAT|planet_technician|RESOURCE|energy|REQUISITION|has_energy_requisitorium|REQUISITION_AMOUNT|@requisitorium_energy_reduction|
			}
		}

		# overlord_resources = {
		# 	category = planet_requisitioned_energy
		# 	produces = {
		# 		trigger = {
		# 			planet = {
		# 				has_planet_flag = has_energy_requisitorium
		# 			}
		# 		}
		# 		energy = @requisitorium_energy_overlord
		# 	}
		# }
		
		inline_script = {
			script = jobs/inline_evolved_technician
			regular_count = 1
			regular_secondary_count = 1
			hive_count = 1
			hive_secondary_count = 1
			machine_count = 1
			machine_secondary_count = 1
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/inline_evolved_technician_secondary
			regular_count = 1
			hive_count = 1
			machine_count = 1
			mult = 1
			display = with_desc
			trigger = ""
		}
	}

	building_tec_machine_anglers_nexus_A = {
		base_buildtime = @b4_time
		empire_limit = {
			base = 1
		}
		base_cap_amount = 1
		position_priority = 30		# Unique
		ai_estimate_without_unemployment = yes

		category = resource

		potential = {
			exists = owner
			owner = {
				is_machine_empire = yes
				tec_is_aquatic_empire = yes
			}
			tec_has_desiccation = no
			NOR = {
				has_modifier = resort_colony 
			}
		}

		triggered_desc = {
			text = tec_building_affect_production_menialbuilding
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 4
			}

			inline_script = {
				script = buildings/resources/inline_evolved_machine_production_cost
				tier = 3
				trigger = ""
			}

			produces = {
				energy = 1
				multiplier = value:tec_automated_production|BASE|12|BASE_VALUE|tec_machine_angler_nexus_base_production|ECO_CAT|planet_technician|RESOURCE|energy|REQUISITION|has_energy_requisitorium|REQUISITION_AMOUNT|@requisitorium_energy_reduction|
			}
		}

		# overlord_resources = {
		# 	category = planet_requisitioned_energy
		# 	produces = {
		# 		trigger = {
		# 			planet = {
		# 				has_planet_flag = has_energy_requisitorium
		# 			}
		# 		}
		# 		energy = @requisitorium_energy_overlord
		# 	}
		# }
		
		inline_script = {
			script = jobs/inline_evolved_technician
			regular_count = 2
			regular_secondary_count = 2
			hive_count = 2
			hive_secondary_count = 2
			machine_count = 2
			machine_secondary_count = 2
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/inline_evolved_technician_secondary
			regular_count = 1
			hive_count = 1
			machine_count = 1
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/inline_evolved_aibait
			trigger = "
				is_capital = yes
			"
		}
	}
# /
# ------------- ARCHAEOTECH -----------------
	building_baol_organic_plant = {
		base_buildtime = @b2_time
		base_cap_amount = 1
		position_priority = 210		# Basic boost
		ai_estimate_without_unemployment = yes

		category = resource

		prerequisites = {
			"tech_secrets_baol"
		}

		potential = {
			exists = owner
			NOR = {
				is_planet_class = pc_machine
				has_modifier = resort_colony
				has_modifier = crucible_colony
			}
			tec_ai_destroy_food_boosting_building = no
		}

		allow = {

			tec_ai_allow_artifacts_dependant_building = yes
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/inline_evolved_resource_cost
				tier = 2
			}
			cost = {
				minor_artifacts = @b2_rare_cost
			}
		}

		# Food plus
			inline_script = {
				script = modifiers/inline_evolved_farmer_efficiency
				count = 1
				mult = 1
				trigger = ""
			}

			triggered_planet_modifier = {
				potential = {
					exists = owner
					owner = {
						is_machine_empire = no
						allows_slavery = yes
					}
				}
				planet_livestock_biological_food_produces_add = 1
			}
		# /

		# Archaeotech modifiers
			triggered_planet_modifier = {
				potential = {
					owner = {
						country_uses_consumer_goods = yes
					}
				}
				planet_farmers_consumer_goods_produces_add = 0.5
			}
			triggered_planet_modifier = {
				potential = {
					owner = {
						country_uses_consumer_goods = yes
						has_ascension_perk = ap_archaeoengineers
					}
				}
				planet_farmers_consumer_goods_produces_add = 0.5
			}

			triggered_planet_modifier = {
				potential = {
					owner = {
						country_uses_consumer_goods = no
					}
				}
				planet_farmers_energy_produces_add = 1
			}
			triggered_planet_modifier = {
				potential = {
					owner = {
						country_uses_consumer_goods = no
						has_ascension_perk = ap_archaeoengineers
					}
				}
				planet_farmers_energy_produces_add = 1
			}
		# /

		inline_script = {	# Jobs
			script = jobs/inline_evolved_farmer
			regular_count = 2
			regular_secondary_count = 2
			hive_count = 2
			hive_secondary_count = 2
			machine_count = 2
			machine_secondary_count = 2
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/inline_evolved_aibait
			trigger = "
				check_variable_arithmetic = {
					which = value:farming_combined_value
					value >= 4
				}
			"
		}
	}
# /